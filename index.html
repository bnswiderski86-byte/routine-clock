<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Routine Clock ‚Äì Parent Setup</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      margin: 0;
      padding: 1.5rem;
      background: #f5f7fb;
      color: #222;
    }
    h1 {
      margin-top: 0;
      font-size: 1.8rem;
    }
    .section {
      background: #fff;
      border-radius: 8px;
      padding: 1rem;
      margin-bottom: 1.5rem;
      box-shadow: 0 2px 6px rgba(0,0,0,0.05);
    }
    label {
      font-weight: 600;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 0.5rem;
    }
    th, td {
      border-bottom: 1px solid #e1e4f0;
      padding: 0.4rem;
      text-align: left;
      font-size: 0.9rem;
    }
    input[type="text"], input[type="time"] {
      width: 100%;
      padding: 0.25rem 0.4rem;
      font-size: 0.9rem;
    }
    .buttons {
      display: flex;
      gap: 0.75rem;
      margin-top: 1rem;
      flex-wrap: wrap;
    }
    button {
      padding: 0.5rem 1rem;
      font-size: 1rem;
      border-radius: 6px;
      border: none;
      cursor: pointer;
    }
    .primary {
      background: #4f46e5;
      color: #fff;
    }
    .secondary {
      background: #e5e7eb;
      color: #111827;
    }
    .danger {
      background: #ef4444;
      color: #fff;
    }
    .palette-swatches {
      display: flex;
      gap: 0.75rem;
      margin-top: 0.5rem;
      flex-wrap: wrap;
    }
    .swatch {
      display: flex;
      align-items: center;
      gap: 0.3rem;
      cursor: pointer;
    }
    .swatch-colors {
      display: inline-flex;
      overflow: hidden;
      border-radius: 999px;
      border: 1px solid #cbd5f5;
    }
    .swatch-colors span {
      width: 14px;
      height: 14px;
    }
    .small-note {
      font-size: 0.8rem;
      color: #6b7280;
      margin-top: 0.25rem;
    }
    .row-buttons {
      display: flex;
      gap: 0.5rem;
      margin-top: 0.5rem;
      flex-wrap: wrap;
    }
  </style>
</head>
<body>
  <h1>Routine Clock ‚Äì Parent Setup</h1>
  <p>Use this page to create your child‚Äôs schedule. When you click ‚ÄúSave &amp; View Clock‚Äù, this device will remember your schedule and show it on the clock page.</p>

  <!-- Palette -->
  <div class="section">
    <h2>1. Choose color palette</h2>
    <p class="small-note">Pick the colors for the wedges on the clock.</p>
    <div class="palette-swatches">
      <label class="swatch">
        <input type="radio" name="palette" value="soft" checked />
        <span>Soft</span>
        <span class="swatch-colors">
          <span style="background:#fde68a"></span>
          <span style="background:#bfdbfe"></span>
          <span style="background:#bbf7d0"></span>
          <span style="background:#fecaca"></span>
        </span>
      </label>
      <label class="swatch">
        <input type="radio" name="palette" value="bold" />
        <span>Bold</span>
        <span class="swatch-colors">
          <span style="background:#f97316"></span>
          <span style="background:#22c55e"></span>
          <span style="background:#3b82f6"></span>
          <span style="background:#e11d48"></span>
        </span>
      </label>
      <label class="swatch">
        <input type="radio" name="palette" value="calm" />
        <span>Calm</span>
        <span class="swatch-colors">
          <span style="background:#a5b4fc"></span>
          <span style="background:#7dd3fc"></span>
          <span style="background:#6ee7b7"></span>
          <span style="background:#fde68a"></span>
        </span>
      </label>
    </div>
  </div>

  <!-- Weekday day -->
  <div class="section">
    <h2>2. Weekday daytime schedule (Mon‚ÄìFri)</h2>
    <p class="small-note">Mon-Fri Schedule. Day mode runs from 7am to 7pm. Please enter your weekday schedule from 7am to 7pm.</p>
    <table>
      <thead>
        <tr>
          <th>Activity</th>
          <th>Start</th>
          <th>End</th>
          <th>Icon (emoji)</th>
        </tr>
      </thead>
      <tbody id="weekday-day-rows">
        <tr>
          <td><input type="text" value="Wake up" /></td>
          <td><input type="time" value="07:00" /></td>
          <td><input type="time" value="07:30" /></td>
          <td><input type="text" value="‚òÄÔ∏è" /></td>
        </tr>
        <tr>
          <td><input type="text" value="Breakfast" /></td>
          <td><input type="time" value="07:30" /></td>
          <td><input type="time" value="08:00" /></td>
          <td><input type="text" value="ü•û" /></td>
        </tr>
        <tr>
          <td><input type="text" value="School / Care" /></td>
          <td><input type="time" value="08:00" /></td>
          <td><input type="time" value="15:00" /></td>
          <td><input type="text" value="üè´" /></td>
        </tr>
        <tr>
          <td><input type="text" value="Snack" /></td>
          <td><input type="time" value="15:00" /></td>
          <td><input type="time" value="15:30" /></td>
          <td><input type="text" value="üçé" /></td>
        </tr>
        <tr>
          <td><input type="text" value="Play time" /></td>
          <td><input type="time" value="15:30" /></td>
          <td><input type="time" value="17:00" /></td>
          <td><input type="text" value="üß∏" /></td>
        </tr>
        <tr>
          <td><input type="text" value="Dinner" /></td>
          <td><input type="time" value="17:00" /></td>
          <td><input type="time" value="18:00" /></td>
          <td><input type="text" value="üçΩÔ∏è" /></td>
        </tr>
      </tbody>
    </table>
    <div class="row-buttons">
      <button type="button" class="secondary" id="add-weekday-day-row">
        + Add weekday daytime activity
      </button>
      <button type="button" class="danger" id="remove-weekday-day-row">
        ‚àí Remove last
      </button>
    </div>
    

  <!-- Weekday night -->
  <div class="section">
    <h2>3. Weekday night schedule (Mon‚ÄìFri)</h2>
    <p class="small-note">Mon-Fri Schedule. Night mode runs from 7pm to 7am. Please enter your weekday night schedule from 7pm to 7am.</p>
    <table>
      <thead>
        <tr>
          <th>Activity</th>
          <th>Start</th>
          <th>End</th>
          <th>Icon (emoji)</th>
        </tr>
      </thead>
      <tbody id="weekday-night-rows">
        <tr>
          <td><input type="text" value="Screen / Chill" /></td>
          <td><input type="time" value="18:00" /></td>
          <td><input type="time" value="19:00" /></td>
          <td><input type="text" value="üì∫" /></td>
        </tr>
        <tr>
          <td><input type="text" value="Bath" /></td>
          <td><input type="time" value="19:00" /></td>
          <td><input type="time" value="19:30" /></td>
          <td><input type="text" value="üõÅ" /></td>
        </tr>
        <tr>
          <td><input type="text" value="Story / Wind down" /></td>
          <td><input type="time" value="19:30" /></td>
          <td><input type="time" value="20:00" /></td>
          <td><input type="text" value="üìñ" /></td>
        </tr>
        <tr>
          <td><input type="text" value="Sleep" /></td>
          <td><input type="time" value="20:00" /></td>
          <td><input type="time" value="07:00" /></td>
          <td><input type="text" value="üåô" /></td>
        </tr>
      </tbody>
    </table>
    <div class="row-buttons">
      <button type="button" class="secondary" id="add-weekday-night-row">
        + Add weekday night activity
      </button>
      <button type="button" class="danger" id="remove-weekday-night-row">
        ‚àí Remove last
      </button>
    </div>
  </div>

  <!-- Weekend day -->
  <div class="section">
    <h2>4. Weekend daytime schedule (Sat‚ÄìSun)</h2>
    <p class="small-note">Sat&Sun day mode runs from 8am to 8pm. Please enter your weekend day schedule from 8am to 8pm.</p>
    <table>
      <thead>
        <tr>
          <th>Activity</th>
          <th>Start</th>
          <th>End</th>
          <th>Icon (emoji)</th>
        </tr>
      </thead>
      <tbody id="weekend-day-rows">
        <tr>
          <td><input type="text" value="Wake up" /></td>
          <td><input type="time" value="08:00" /></td>
          <td><input type="time" value="08:30" /></td>
          <td><input type="text" value="‚è∞" /></td>
        </tr>
        <tr>
          <td><input type="text" value="Breakfast" /></td>
          <td><input type="time" value="08:30" /></td>
          <td><input type="time" value="09:00" /></td>
          <td><input type="text" value="ü•û" /></td>
        </tr>
        <tr>
          <td><input type="text" value="Free play / Outing" /></td>
          <td><input type="time" value="09:00" /></td>
          <td><input type="time" value="12:00" /></td>
          <td><input type="text" value="üß∏" /></td>
        </tr>
        <tr>
          <td><input type="text" value="Lunch" /></td>
          <td><input type="time" value="12:00" /></td>
          <td><input type="time" value="13:00" /></td>
          <td><input type="text" value="ü•™" /></td>
        </tr>
        <tr>
          <td><input type="text" value="Afternoon play" /></td>
          <td><input type="time" value="13:00" /></td>
          <td><input type="time" value="17:00" /></td>
          <td><input type="text" value="üé®" /></td>
        </tr>
        <tr>
          <td><input type="text" value="Dinner" /></td>
          <td><input type="time" value="17:00" /></td>
          <td><input type="time" value="18:00" /></td>
          <td><input type="text" value="üçΩÔ∏è" /></td>
        </tr>
      </tbody>
    </table>
    <div class="row-buttons">
      <button type="button" class="secondary" id="add-weekend-day-row">
        + Add weekend daytime activity
      </button>
      <button type="button" class="danger" id="remove-weekend-day-row">
        ‚àí Remove last
      </button>
    </div>
  </div>

  <!-- Weekend night -->
  <div class="section">
    <h2>5. Weekend night schedule (Sat‚ÄìSun)</h2>
    <p class="small-note">Sat & Sun night mode runs from 8pm to 8am. Please enter your weekend night schedule from 8pm to 8am.</p>
    <table>
      <thead>
        <tr>
          <th>Activity</th>
          <th>Start</th>
          <th>End</th>
          <th>Icon (emoji)</th>
        </tr>
      </thead>
      <tbody id="weekend-night-rows">
        <tr>
          <td><input type="text" value="Screen / Chill" /></td>
          <td><input type="time" value="18:00" /></td>
          <td><input type="time" value="19:00" /></td>
          <td><input type="text" value="üì∫" /></td>
        </tr>
        <tr>
          <td><input type="text" value="Bath" /></td>
          <td><input type="time" value="19:00" /></td>
          <td><input type="time" value="19:30" /></td>
          <td><input type="text" value="üõÅ" /></td>
        </tr>
        <tr>
          <td><input type="text" value="Story / Wind down" /></td>
          <td><input type="time" value="19:30" /></td>
          <td><input type="time" value="20:00" /></td>
          <td><input type="text" value="üìñ" /></td>
        </tr>
        <tr>
          <td><input type="text" value="Sleep" /></td>
          <td><input type="time" value="20:00" /></td>
          <td><input type="time" value="08:00" /></td>
          <td><input type="text" value="üåô" /></td>
        </tr>
      </tbody>
    </table>
    <div class="row-buttons">
      <button type="button" class="secondary" id="add-weekend-night-row">
        + Add weekend night activity
      </button>
      <button type="button" class="danger" id="remove-weekend-night-row">
        ‚àí Remove last
      </button>
    </div>
  </div>

  <!-- Save section -->
  <div class="section">
    <h2>6. Save and open the clock</h2>
    <p class="small-note">
      This saves only on this device in this browser. To use on another device, open this page there and set the schedule again.
    </p>
    <div class="buttons">
      <button class="primary" id="save-and-open">Save &amp; View Clock</button>
      <button class="secondary" id="clear-schedule" type="button">Clear saved schedule on this device</button>
    </div>
    <p id="status" class="small-note"></p>
  </div>

  <script>
    const PALETTES = {
      soft: ["#fde68a", "#bfdbfe", "#bbf7d0", "#fecaca", "#e9d5ff", "#fee2e2"],
      bold: ["#f97316", "#22c55e", "#3b82f6", "#e11d48", "#a855f7", "#0ea5e9"],
      calm: ["#a5b4fc", "#7dd3fc", "#6ee7b7", "#fde68a", "#f9a8d4", "#c4b5fd"]
    };

    function addActivityRow(tbodyId) {
      const tbody = document.getElementById(tbodyId);
      if (!tbody) return;
      const currentRows = tbody.querySelectorAll("tr").length;
      if (currentRows >= 15) return;

      const tr = document.createElement("tr");
      tr.innerHTML = `
        <td><input type="text" value="" /></td>
        <td><input type="time" value="" /></td>
        <td><input type="time" value="" /></td>
        <td><input type="text" value="" /></td>
      `;
      tbody.appendChild(tr);
    }

    function removeLastRow(tbodyId) {
      const tbody = document.getElementById(tbodyId);
      if (!tbody) return;
      const rows = tbody.querySelectorAll("tr");
      if (rows.length <= 1) return;
      tbody.removeChild(rows[rows.length - 1]);
    }

    function ensureRows(count, tbodySelector) {
      const tbody = document.querySelector(tbodySelector);
      if (!tbody) return;
      while (tbody.querySelectorAll("tr").length < count &&
             tbody.querySelectorAll("tr").length < 15) {
        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td><input type="text" value="" /></td>
          <td><input type="time" value="" /></td>
          <td><input type="time" value="" /></td>
          <td><input type="text" value="" /></td>
        `;
        tbody.appendChild(tr);
      }
    }

    function fillTable(tasks, tbodySelector) {
      if (!tasks) return;
      ensureRows(tasks.length, tbodySelector);
      const rows = document.querySelectorAll(`${tbodySelector} tr`);
      tasks.forEach((task, i) => {
        if (!rows[i]) return;
        const inputs = rows[i].querySelectorAll("input");
        inputs[0].value = task.label || "";
        inputs[1].value = task.start || "";
        inputs[2].value = task.end || "";
        inputs[3].value = task.icon || "";
      });
    }

    function collectTasks(tableId, colors) {
      const rows = document.querySelectorAll(`#${tableId} tr`);
      const tasks = [];
      let colorIndex = 0;

      rows.forEach(row => {
        const inputs = row.querySelectorAll("input");
        const label = inputs[0].value.trim();
        const start = inputs[1].value;
        const end = inputs[2].value;
        const icon = inputs[3].value.trim();

        if (!label || !start || !end) return;

        const color = colors[colorIndex % colors.length];
        colorIndex++;

        tasks.push({ label, start, end, color, icon: icon || "‚¨§" });
      });

      return tasks;
    }

    document.addEventListener("DOMContentLoaded", () => {
      const map = [
        ["add-weekday-day-row", "remove-weekday-day-row", "weekday-day-rows"],
        ["add-weekday-night-row", "remove-weekday-night-row", "weekday-night-rows"],
        ["add-weekend-day-row", "remove-weekend-day-row", "weekend-day-rows"],
        ["add-weekend-night-row", "remove-weekend-night-row", "weekend-night-rows"]
      ];

      map.forEach(([addId, removeId, tbodyId]) => {
        const addBtn = document.getElementById(addId);
        const removeBtn = document.getElementById(removeId);
        if (addBtn) addBtn.addEventListener("click", () => addActivityRow(tbodyId));
        if (removeBtn) removeBtn.addEventListener("click", () => removeLastRow(tbodyId));
      });

      try {
        const raw = localStorage.getItem("routineClockSchedule");
        if (raw) {
          const data = JSON.parse(raw);

          if (data && data.palette &&
              document.querySelector(`input[name="palette"][value="${data.palette}"]`)) {
            document
              .querySelector(`input[name="palette"][value="${data.palette}"]`)
              .checked = true;
          }

          if (data.mon_fri) {
            fillTable(data.mon_fri.day, "#weekday-day-rows");
            fillTable(data.mon_fri.night, "#weekday-night-rows");
          }
          if (data.weekend) {
            fillTable(data.weekend.day, "#weekend-day-rows");
            fillTable(data.weekend.night, "#weekend-night-rows");
          }
        }
      } catch (e) {
        console.error("Error loading existing schedule", e);
      }

      const saveBtn = document.getElementById("save-and-open");
      if (saveBtn) {
        saveBtn.addEventListener("click", () => {
          const status = document.getElementById("status");
          if (status) status.textContent = "";

          const paletteInput = document.querySelector('input[name="palette"]:checked');
          const paletteKey = paletteInput ? paletteInput.value : "soft";
          const colors = PALETTES[paletteKey];

          const weekdayDay = collectTasks("weekday-day-rows", colors);
          const weekdayNight = collectTasks("weekday-night-rows", colors);
          const weekendDay = collectTasks("weekend-day-rows", colors);
          const weekendNight = collectTasks("weekend-night-rows", colors);

          if (
            weekdayDay.length === 0 &&
            weekdayNight.length === 0 &&
            weekendDay.length === 0 &&
            weekendNight.length === 0
          ) {
            if (status) status.textContent = "Please add at least one activity before saving.";
            return;
          }

          const scheduleData = {
            palette: paletteKey,
            mon_fri: {
              day: weekdayDay,
              night: weekdayNight
            },
            weekend: {
              day: weekendDay,
              night: weekendNight
            }
          };

          try {
            localStorage.setItem("routineClockSchedule", JSON.stringify(scheduleData));
            if (status) status.textContent = "Schedule saved on this device. Opening clock‚Ä¶";
            window.location.href =
              "https://bnswiderski86-byte.github.io/routine-clock/clock.html";
          } catch (e) {
            console.error("Error saving schedule", e);
            if (status) {
              status.textContent =
                "There was a problem saving. Make sure this browser allows local storage.";
            }
          }
        });
      }

      const clearBtn = document.getElementById("clear-schedule");
      if (clearBtn) {
        clearBtn.addEventListener("click", () => {
          localStorage.removeItem("routineClockSchedule");
          const status = document.getElementById("status");
          if (status) status.textContent = "Saved schedule cleared on this device.";
        });
      }
    });
  </script>
</body>
</html>








